CREATE TABLE IF NOT EXISTS users
(
    id   BIGINT       NOT NULL PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,
    nick VARCHAR(255) NOT NULL
);

CREATE TABLE IF NOT EXISTS publication_types
(
    id   BIGINT       NOT NULL PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,
    type VARCHAR(255) NOT NULL
);

CREATE TABLE IF NOT EXISTS publications
(
    id        BIGINT NOT NULL PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,
    author_id BIGINT NOT NULL REFERENCES users (id),
    type_id   BIGINT NOT NULL REFERENCES publication_types (id),
    entity_id BIGINT
);

CREATE TABLE IF NOT EXISTS photos
(
    id   BIGINT       NOT NULL PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,
    name VARCHAR(255) NOT NULL
);


CREATE TABLE IF NOT EXISTS comments
(
    id   BIGINT NOT NULL PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,
    text TEXT   NOT NULL
);

CREATE TABLE IF NOT EXISTS likes
(
    id             BIGINT NOT NULL PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,
    user_id        BIGINT NOT NULL REFERENCES users (id),
    publication_id BIGINT NOT NULL REFERENCES publications (id),
    CONSTRAINT unique_like UNIQUE (user_id, publication_id)
);
